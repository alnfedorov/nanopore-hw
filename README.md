## –ì—Ä—É–ø–ø–∞ G4 / SRR11461739, SRR11461738

–£—á–∞—Å—Ç–Ω–∏–∫–∏:  
* –°–æ–∫–æ–ª–æ–≤ –í–∞—Å–∏–ª–∏–π –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á
* –¢–µ—Ä–µ–Ω—Ç—å–µ–≤–∞ –Æ–ª–∏—è –ê–Ω–¥—Ä–µ–µ–≤–Ω–∞
* –§–∞—Ç—Ç–∞—Ö–æ–≤ –ê–π–¥–∞—Ä –ò–ª—å–≥–∏–∑–æ–≤–∏—á
* –§–µ–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ù–∏–∫–æ–ª–∞–µ–≤–∏—á

–ü–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ github –Ω–µ —Ö–æ—á–µ—Ç –∑–∞—á–µ—Å—Ç—å –Æ–ª–∏—é –≤ contributors, —Ö–æ—Ç—è –æ–Ω–∞ –±–æ–ª—å—à–∞—è –º–æ–ª–æ–¥–µ—Ü –∏ –µ–µ –∫–æ–º–º–∏—Ç—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å ü§î.

### –®–∞–≥ 0 - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–†–∞–±–æ—Ç–∞—Ç—å –±—É–¥–µ–º —Å –ø–∞–∫–µ—Ç–Ω—ã–º–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º **conda**, –¥–ª—è —á–µ–≥–æ-—Ç–æ –¥—Ä—É–≥–æ–≥–æ(–Ω–∞–ø—Ä–∏–º–µ—Ä Docker-a) –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–∞–≤ –Ω–µ—Ç. –°—Ç–∞–≤–∏–º –≤—Å–µ –∏—Å–∫–æ–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã:
```shell
# –ù–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
conda create -y --name nanopore-hw
conda activate nanopore-hw

# –ü–∞–∫–µ—Ç—ã
conda install -y -c bioconda \
	sra-tools \ # fastq-dump 
	fastqc    \ # qc
	multiqc   \ # qc
	porechop  \ # nanopore trimming
	filtlong  \ # long reads filtering
	unicycler   # bacterial genome assembler
```

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, bioconda —Ä–µ—Ü–µ–ø—Ç –¥–ª—è r-minionqc(qc –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏–π) —Å–ª–æ–º–∞–Ω, r-minionqc –Ω–µ —Å—Ç–∞–≤–∏—Ç—Å—è –¥–∞–∂–µ –≤ —á–∏—Å—Ç–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ. 
–ü–æ—Å—Ç–∞–≤–∏–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ conda, –∞ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ—Å—Ç–æ —Å–∫–∞—á–∞–µ–º:

```shell
conda install -y r-data.table r-futile.logger r-ggplot2 r-optparse r-plyr r-readr r-reshape2 r-scales r-viridis r-yaml
wget https://raw.githubusercontent.com/roblanf/minion_qc/master/MinIONQC.R -O MinIONQC.R
```
### –®–∞–≥ 1 - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏–π

–í—ã–ø–æ–ª–Ω–∏–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –¥–ª—è `fastq-dump`. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ save-exit, –Ω–µ –æ—á–µ–Ω—å –ø–æ–Ω—è—Ç–Ω–æ –∑–∞—á–µ–º –æ–Ω–∞ —Å–¥–µ–ª–∞–ª–∏ –µ–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π.

```shell
vdb-config --interactive
```

–ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—à–∏ –ø—Ä–æ—á—Ç–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å gzip –Ω–µ –±—É–¥–µ–º, –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ —Å–≤–æ–±–æ–¥–Ω–æ –ø–æ—Ä—è–¥–∫–∞ 3TB:
```shell
mkdir -p fastq/SRR11461738 fastq/SRR11461739

# paired end
fastq-dump --split-files -O fastq/SRR11461738 SRR11461738

# long reads
fastq-dump -O fastq/SRR11461739 SRR11461739
```

### –®–∞–≥ 3 - –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞

–°–¥–µ–ª–∞–µ–º –ø–æ–¥–≤—ã–±–æ—Ä–∫—É –¥–ª–∏–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏–π (--length_weight 10 –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏–º–µ–Ω–Ω–æ –¥–ª–∏–Ω–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏–π):
```shell
filtlong --min_length 1000 --target_bases 400000000 --length_weight 10 fastq/SRR11461739/SRR11461739.fastq > fastq/SRR11461739/SRR11461739.filtlong.fastq
```

–ï—Å–ª–∏ —Å—É–¥–∏—Ç—å –ø–æ [twitter](https://twitter.com/rrwick/status/1134058857334886401?lang=en)(–Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ google –Ω–µ –Ω–∞—à–ª–æ—Å—å) 
—Ç–æ guppy —É–∂–µ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ù–∞—à–∏ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Å 2020-–≥–æ –≥–æ–¥–∞, –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ —Ç–∞–º –Ω–µ—Ç. 
–û–¥–Ω–∞–∫–æ, –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π, –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è porechop
```shell
porechop -i fastq/SRR11461739/SRR11461739.filtlong.fastq -o fastq/SRR11461739/SRR11461739.trimmed.filtlong.fastq
```

–ó–∞–±–∞–≤–Ω–æ, –∞–¥–∞–ø—Ç–µ—Ä—ã –Ω–∞—à–ª–∏—Å—å, –ø—Ä–∏—Ç–æ–º –ø–æ—á—Ç–∏ –≤–µ–∑–¥–µ:
```shell
27,031 / 29,786 reads had adapters trimmed from their start (1,001,422 bp removed)
24,766 / 29,786 reads had adapters trimmed from their end (371,069 bp removed)
3,291 / 29,786 reads were split based on middle adapters
```

–í –∏–¥–µ–∞–ª–µ porechop –Ω–∞–¥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏—è—Ö, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –¥–µ–ª–∞—Ç—å filtlong. –û–¥–Ω–∞–∫–æ –¥–ª—è —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ 
–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç RAM, –∞ —Å–¥–µ–ª–∞—Ç—å swap –Ω–µ—Ç –ø—Ä–∞–≤. –û—Å—Ç–∞–≤–∏–º –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ –≤ –±–æ–µ–≤–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –±—ã–ª–æ –±—ã —á—Ç–æ-—Ç–æ –ø—Ä–∏–¥—É–º–∞—Ç—å
(–∫—É–ø–∏—Ç—å RAM/–Ω–∞–ø–∏—Å–∞—Ç—å —Å–∏—Å. –∞–¥–º–∏–Ω—É/—Ä–∞–∑–±–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ/—Ç.–¥.).

### –®–∞–≥ 4 - qc

–°–æ–∑–¥–∞–µ–º —Ç—Ä–µ–±—É–µ–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º fastqc:
```shell
mkdir -p qc/fastqc qc/minionqc

fastqc -t 16 -o qc/fastqc fastq/SRR11461738/SRR11461738_* fastq/SRR11461739/SRR11461739.*
```

–ü–æ–ø—Ä–æ–±—É–µ–º minionqc –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö/–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö/–æ–±—Ä–µ–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏—è—Ö:
```shell
Rscript MinIONQC.R -p 16 -i fastq/SRR11461739/SRR11461739.fastq -o qc/minionqc/SRR11461739
Rscript MinIONQC.R -p 16 -i fastq/SRR11461739/SRR11461739.filtlong.fastq -o qc/minionqc/SRR11461739.filtlong
Rscript MinIONQC.R -p 16 -i fastq/SRR11461739/SRR11461739.trimmed.filtlong.fastq -o qc/minionqc/SRR11461739.trimmed.filtlong.fastq
```

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö minionqc —É–ø–∞–ª —Å –æ—à–∏–±–∫–æ–π —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞:
```shell
INFO [2020-11-03 22:17:20] Loading input file: fastq/SRR11461739/SRR11461739.filtlong.fastq
WARN [2020-11-03 22:17:26] There were problems in parsing your input file with the following rows: 
WARN [2020-11-03 22:17:26] 895
WARN [2020-11-03 22:17:26] 895
WARN [2020-11-03 22:17:26] 895
# –ü–æ–≤—Ç–æ—Ä –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—ã—Å—è—á–∏ —Ä–∞–∑...
WARN [2020-11-03 22:17:26] 1095
# –ü–æ–≤—Ç–æ—Ä –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—ã—Å—è—á–∏ —Ä–∞–∑... + –µ—â–µ –¥–µ—Å—è—Ç–æ–∫ –ø–æ–¥–æ–±–Ω—ã—Ö –æ—à–∏–±–æ–∫
Error: Assigned data `as.numeric(as.character(d$sequence_length_template))` must be compatible with existing data.
‚úñ Existing data has 64525 rows.
‚úñ Assigned data has 0 rows
Backtrace:
     ‚ñà
  1. ‚îî‚îÄglobal::single.flowcell(input.file, output.dir, q)
  2.   ‚îî‚îÄglobal::load_summary(input.file, min.q = c(-Inf, q))
  3.     ‚îú‚îÄbase::`$<-`(`*tmp*`, "sequence_length_template", value = numeric(0))
  4.     ‚îî‚îÄtibble:::`$<-.tbl_df`(`*tmp*`, "sequence_length_template", value = numeric(0))
  5.       ‚îî‚îÄtibble:::tbl_subassign(...)
  6.         ‚îî‚îÄtibble:::vectbl_recycle_rhs(...)
  7.           ‚îî‚îÄbase::tryCatch(...)
  8.             ‚îî‚îÄbase:::tryCatchList(expr, classes, parentenv, handlers)
  9.               ‚îî‚îÄbase:::tryCatchOne(expr, names, parentenv, handlers[[1L]])
 10.        
Execution halted
```
–í github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤–∏—Å–∏—Ç [issue](https://github.com/roblanf/minion_qc/issues/49) –Ω–∞ –ø–æ–¥–æ–±–Ω—É—é –æ—à–∏–±–∫—É —Å –ø–æ–º–µ—Ç–∫–æ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ. 
–¢–æ–ª—å–∫–æ –Ω–∞—à–∞ –æ—à–∏–±–∫–∞ - —ç—Ç–æ –ø–∞–¥–µ–Ω–∏–µ –≤ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ. –¢.–∫. —ç—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –ø–æ–≤–µ—Ä–∏–º —á—Ç–æ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Ö–æ—Ä–æ—à–∏–µ –∏ —É–≥–ª—É–±–ª—è—Ç—å—Å—è 
–≤ –ø—Ä–æ–±–ª–µ–º—É –Ω–µ –±—É–¥–µ–º.  
*P.S. –ö–∞–∑–∞–ª–æ—Å—å –±—ã, –µ—Å—Ç—å –ª–∏ —Å–≤—è–∑—å –º–µ–∂–¥—É —è–∑—ã–∫–æ–º –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º —É—Ç–∏–ª–∏—Ç? –ê –≤–µ–¥—å —Ç—É–ª—ã –Ω–∞ R –æ—á–µ–Ω—å —á–∞—Å—Ç–æ –∏–∑ –∫–æ—Ä–æ–±–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç...*

–ê–≥—Ä–µ–≥–∏—Ä—É–µ–º qc-–æ—Ç—á–µ—Ç:
```shell
multiqc -o qc qc
```
MultiQC –æ—Ç—á–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ [—Å—Å—ã–ª–∫–µ](https://htmlpreview.github.io/?https://github.com/alnfedorov/nanopore-hw/blob/master/qc/multiqc_report.html).

–ò–∑ –æ—Ç—á–µ—Ç–∞ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∞–¥–∞–ø—Ç–µ—Ä—ã —É –ø–∞—Ä–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏–π —É–∂–µ –æ–±—Ä–µ–∑–∞–Ω—ã, –æ–¥–Ω–∞–∫–æ –µ—Å—Ç—å —Å—Ç—Ä–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ –ø–µ—Ä–≤—ã—Ö 20 –∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 –ø–æ–∑–∏—Ü–∏—è—Ö. 
–ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–µ–∫–≤–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Illumina(–±—É–¥–µ—Ç –∑–¥–æ—Ä–æ–≤–æ, –µ—Å–ª–∏ –í—ã –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç–µ).  
–ß—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –æ–±—Ä–µ–∑–∞—Ç—å –∏—Ö –Ω–µ –±—É–¥–µ–º. –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –ø–æ–ª—É—á–∏—Ç—Å—è –ø–ª–æ—Ö–æ–π, —Ç–æ –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–±—Ä–µ–∑–∞—Ç—å.

–î–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–ª–∏–Ω–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏–π —Ç–∞–∫–æ–µ –ø–æ—á—Ç–∏ –Ω–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ, –Ω–æ 5\` –∫–æ–Ω–µ—Ü —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –æ–±—Ä–µ–∑–∞—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.  
–°—Ç—Ä–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 3\` –∫–æ–Ω—Ü–µ –º–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ - –Ω–∞—Å—Ç–æ–ª—å–∫–æ –¥–ª–∏–Ω–Ω—ã—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏–π –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ.

### –®–∞–≥ 5 - —Å–±–æ—Ä–∫–∞ –≥–µ–Ω–æ–º–∞

–°—Ç–∞–≤–∏–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `unicycler` `racon`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω–µ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `conda` —Å—Ä–∞–∑—É.
–ó–∞—Ç–µ–º —Å–æ–±–∏—Ä–∞–µ–º –±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π –≥–µ–Ω–æ–º –≤ –≥–∏–±—Ä–∏–¥–Ω–æ–º —Ä–µ–∂–∏–º–µ(–¥–ª–∏–Ω–Ω—ã–µ + –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è):
```shell
conda install -c bioconda racon

unicycler -1 fastq/SRR11461738/SRR11461738_1.fastq -2 fastq/SRR11461738/SRR11461738_2.fastq \
	  -l fastq/SRR11461739/SRR11461739.trimmed.filtlong.fastq -o assembly -t 16 & disown
```
–õ–æ–≥ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ñ–∞–π–ª–µ `assembly/unicycler.log`.  

–ü—Ä–∏ –ø–æ–ª–∏—Ä–æ–≤–∫–µ —Å–±–æ—Ä–∫–∏ `pilon` —É–ø–∞–ª —Å OutOfMemoryError, —Ç.–∫. –≤ jvm —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ –Ω–µ–±–æ–ª—å—à–æ–π. 
–ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ jvm –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É/–ø–æ–ª–∏—Ä–æ–≤–∫—É, –Ω–æ –≤ –Ω–∞—à–µ–º —É—á–µ–±–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç —É–ø—É—Å—Ç–∏–º.

–í —Ñ–∏–Ω–∞–ª–µ –ø–æ–ª—É—á–∏–ª–∞—Å—å –æ–¥–Ω–∞ –∫–æ–ª—å—Ü–µ–≤–∞—è —Ö—Ä–æ–º–æ—Å–æ–º–∞:

```shell
cat assembly/assembly.fasta | grep ">"

# >1 length=4215612 depth=1.00x circular=true
```

### –®–∞–≥ 6 - BLAST

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫ –∫–∞–∫–æ–º—É –≤–∏–¥—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Å–æ–±—Ä–∞–Ω–Ω–∞—è –±–∞–∫—Ç–µ—Ä–∏—è, –≤–æ—Å–ø–ø–æ–ª—å–∑—É–µ–º—Å—è NCBI Blast. –°–æ–±—Ä–∞–Ω–Ω—ã–π –≥–µ–Ω–æ–º –æ–∫–∞–∑–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º 
–¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ–≥–æ –≤ blastn, –ø–æ—ç—Ç–æ–º—É –æ–Ω –±—ã–ª —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —á–∞—Å—Ç–∏ –¥–ª–∏–Ω–æ–π –ø–æ 5000 –ø–Ω (+–æ—Å—Ç–∞—Ç–æ–∫) –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:
```shell
split -l 5000  --numeric-suffixes assembly/assembly.fasta
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã blastn —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ—Ä–≥–∞–Ω–∏–∑–º - bacteria (taxid:2).
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–±–æ—Ç—ã blastn –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ –¥–∞–Ω–Ω–∞—è –±–∞–∫—Ç–µ—Ä–∏—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫ Bacillus subtilis.

### –®–∞–≥ 7 - Bandage

–£—Å—Ç–∞–Ω–æ–≤–∏–º Bandage –Ω–∞ –¥–æ–º–∞—à–Ω–µ–º –Ω–æ—É—Ç–±—É–∫–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–æ–º–∞–Ω–¥—ã `conda install Bandage`.

–ù–∞ –≤—Ö–æ–¥ `Bandage` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .gfa, —Ç–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ unicycler, –ø—Ä–∏—á–µ–º –º—ã –∏–º–µ–µ–º –Ω–µ –æ–¥–∏–Ω –∫–æ–Ω–µ—á–Ω—ã–π —Ñ–∞–π–ª –∞ 6 –ø–æ—Å–¥–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∫–∏. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç—Ä–∏ –∏–∑ –Ω–∏—Ö:

![001_best_spades_graph.gfa](https://github.com/VasyaSokolov/nanopore-hw/blob/master/graph1.png)

–ì—Ä–∞—Ñ –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–∫–∞–∑–∞–Ω—ã –¥–ª–∏–Ω–Ω—ã–µ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è - —ç—Ç–æ –≤–µ—Ä—à–∏–Ω—ã, —Ä—ë–±—Ä–∞ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

![004_bridges_applied.gfa](https://github.com/VasyaSokolov/nanopore-hw/blob/master/graph2.png)

–ì—Ä–∞—Ñ –ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±—Ä–∞–Ω–Ω–æ–π —Ö—Ä–æ–º–æ—Å–æ–º—ã –±–∞–∫—Ç–µ—Ä–∏–∏, –≤–µ—Ä—à–∏–Ω—ã –µ—â—ë –Ω–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã, –Ω–æ —Å–±–æ—Ä–∫–∞ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è.

![assembly.gfa](https://github.com/VasyaSokolov/nanopore-hw/blob/master/graph3.png)

–ì—Ä–∞—Ñ –∏–∑ –æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±—Ä–∞–Ω–æ–π –±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π —Ö—Ä–æ–º–æ—Å–æ–º–µ.

### –®–∞–≥ 8 - abricate

–ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π abricate:
```
git clone https://github.com/tseemann/abricate.git
cd abricate/bin
```

–î–ª—è —Ä–∞–±–æ—Ç—ã abricate –Ω—É–∂–µ–Ω —Å–∫—Ä–∏–ø—Ç any2fasta:
```
wget https://raw.githubusercontent.com/tseemann/any2fasta/master/any2fasta
export PATH=~/abricate/bin:$PATH
```

–ê —Ç–∞–∫–∂–µ Path/Tiny.pm:
```
mkdir Path
curl "https://raw.githubusercontent.com/dagolden/Path-Tiny/master/lib/Path/Tiny.pm" > Path/Tiny.pm
```

–°–∫–∞—á–∏–≤–∞–µ–º –±–∞–∑—ã:
`abricate --setupdb`

–ó–∞–ø—É—Å–∫–∞–µ–º:
`abricate assembly/assembly.fasta > hw.out`

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
#FILE	SEQUENCE	START	END	STRAND	GENE	COVERAGE	COVERAGE_MAP	GAPS	%COVERAGE	%IDENTITY	DATABASE	ACCESSION	PRODUCT	RESISTANCE
hw.fasta	1	275436	276356	+	mphK	1-921/921	===============	0/0	100.00	100.00	ncbi	NG_065846.1	macrolide 2'-phosphotransferase MphK	MACROLIDE
hw.fasta	1	604334	605977	-	vmlR	1-1644/1644	===============	0/0	100.00	100.00	ncbi	NG_063831.1	ABC-F type ribosomal protection protein VmlR	LINCOSAMIDE;STREPTOGRAMIN;TIAMULIN
hw.fasta	1	2050924	2053523	-	rphC	1-2606/2607	========/======	6/26	99.35	82.42	ncbi	NG_063825.1	rifamycin-inactivating phosphotransferase RphC	RIFAMYCIN
hw.fasta	1	2735279	2736133	-	aadK	1-855/855	===============	0/0	100.00	100.00	ncbi	NG_047379.1	aminoglycoside 6-adenylyltransferase AadK	STREPTOMYCIN
hw.fasta	1	4184757	4185278	-	satA_Bs	1-522/522	===============	0/0	100.00	100.00	ncbi	NG_064662.1	streptothricin N-acetyltransferase SatA	STREPTOTHRICIN
hw.fasta	1	4187278	4188654	-	tet(L)	1-1377/1377	===============	0/0	100.00	100.00	ncbi	NG_048204.1	tetracycline efflux MFS transporter Tet(L)	TETRACYCLINE
```
